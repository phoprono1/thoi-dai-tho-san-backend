const { createConnection } = require('typeorm'); const config = { type: 'postgres', host: 'localhost', port: 5432, username: 'postgres', password: 'hoangpho', database: 'thoi_dai_tho_san_v2' }; createConnection(config).then(conn => { console.log('Connected'); conn.query('SELECT sct.*, json_agg(sctp.*) as prizes FROM scratch_card_types sct LEFT JOIN scratch_card_type_prizes sctp ON sct.id = sctp.card_type_id WHERE sct.is_active = true GROUP BY sct.id ORDER BY sct.created_at DESC;').then(rows => { console.log('Card types with prizes:', rows.length); conn.close(); process.exit(0); }); }).catch(err => { console.error('Query error:', err.message); process.exit(1); });
